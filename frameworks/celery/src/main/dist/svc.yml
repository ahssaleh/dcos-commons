name: {{FRAMEWORK_NAME}}
scheduler:
  principal: {{FRAMEWORK_PRINCIPAL}}
  user: {{FRAMEWORK_USER}}
pods:
  celery:
    count: {{NODE_COUNT}}
    image: {{CELERY_IMAGE}}
    placement: {{NODE_PLACEMENT}}
    {{#ENABLE_VIRTUAL_NETWORK}}
    networks:
      {{VIRTUAL_NETWORK_NAME}}:
        labels: {{VIRTUAL_NETWORK_PLUGIN_LABELS}}
    {{/ENABLE_VIRTUAL_NETWORK}}
    uris:
      - {{BOOTSTRAP_URI}}
    tasks:
      node:
        goal: RUNNING
        cmd: "./bootstrap --resolve=false && PYTHONPATH=$MESOS_SANDBOX celery worker -l DEBUG"
        configs:
          celeryconfig:
            template: celeryconfig.py.mustache
            dest: celeryconfig.py
        cpus: {{NODE_CPUS}}
        memory: {{NODE_MEM}}
